# di 02 数字图像基础：数学表达+成像

模拟图像：以物理量（连续地）呈现出的图像。

数字图像：先把模拟图像离散化成规则网格，再以某种方式采样得到网格的值，最后对网格的采样值进行离散化。

## 二维数字图像的数学表达

函数表示：

- $f(x,y)$​，$x=[0,M-1],y=[0,N-1]$​。每一个点被叫做像素，pixel。
- $f(\overrightarrow{X})$​。函数值的类型：标量（灰度），矢量（彩色），张量（值是一个矩阵！），二值（01）。

矩阵表示：

- 大概就是，用一个矩阵来表示图像的各个像素值？
- 坐标系统定义：x正方向为右（和往常一样→），y正方向为下（反的↓）。

### 一些概念

注意，二值图像不是灰度图像，二值的值是一种状态。

#### 像素pixel与邻域neighborhood

p：当前观察像素，当前点，热点hot dot。

p的邻域：p位于正方形窗口中心，窗口尺寸为奇数。窗口不是唯一的，可以定义成菱形、圆甚至不对称。

#### 数字图像的面积/像素数量

M\*N的图像：像素总数=M\*N（M\*N个传感器，每像素的面积为σ，则图像的总面积=M\*N\*σ。

在不关心图像物理尺寸的条件下，像素数与面积不加区别。

（用图像的面积去归一化，就是把表达式除MN。

#### 数字图像文件格式

图像文件包含的基本要素：

- 图像属性：尺寸、数据类型（int float vector）、数据组织形式（压缩标准）；
- 成像条件（可缺省）：X线剂量、摆位；
- 图像数据本身。

常见的图像格式：

- Windows Bitmap (BMP)；
- JPEG；
- Tagged Image File Format (TIFF)；
- Graphics Interchange Format (GIF)；
- Portable Network Graphics (PNG)；
- Digital Imaging and Communications in Medicine (DICM)，医疗成像系统；

### 二维卷积 & 傅里叶变换

#### 二维离散信号的卷积

$$
h(x,y)*f(x,y)=\sum_{i=-\infin}^{\infin}\sum_{j=-\infin}^{\infin}
h(i,j)f(x-i,y-j)
$$

和一维卷积的定义相像。

计算方法：水平翻折，竖直翻折，重叠，对应相乘，求和。

#### 二维傅里叶变换

从此不再用角频率ω了，用频率u，$ω=2\pi u$。​
$$
F(u,v)=\int\int f(x,y)e^{-j2\pi(ux+vy)}dxdy
\\
f(x,y)=\int\int F(u,v)e^{j2\pi(ux+vy)}dudv
$$
对比一维傅里叶变换：
$$
X(u)=\int x(t)e^{-j2\pi ut}dt
\\
x(t)=\int X(u)e^{j2\pi ut}du
$$
一维傅里叶变换的所有性质（线性、微分、时延、相移、卷积），二维傅里叶变换都有。

#### 二维离散傅里叶变换

x∈[0,M-1]，y∈[0,N-1]。
$$
F(u,v)=\frac{1}{MN}\sum_{y=0}^{N-1}\sum_{x=0}^{M-1}
f(x,y)e^{-j2\pi[xu/M+yv/N]}
\\
f(x,y)=\sum_{v=0}^{N-1}\sum_{u=0}^{M-1}
F(u,v)e^{j2\pi[xu/M+yv/N]}
$$
不需要二维fft工具，因为可以分解为一维来做：
$$
F(u,v)=\frac1N\sum_{y=0}^{N-1}\left[\frac1M\sum_{x=0}^{M-1}
f(x,y)e^{-j2\pi xu/M}\right]e^{-j2\pi yv/N}
\\
F(u,y)=\frac1M\sum_{x=0}^{M-1}f(x,y)e^{-j2\pi xu/M}
\\
F(u,v)=\frac1N\sum_{y=0}^{N-1}F(u,y)e^{-j2\pi yv/N}
$$
先对每一行做fft，把fft的结果仍然摆成一个相同尺寸的矩阵，再一列一列地做fft。

## 成像 & 图像数字化

传感器：将一种能量形式变成电信号的元器件。

老师的科研经验：做成像系统，要注意传感器信噪比。

- 成像物理模型：目标信息和信息载体（能量形式 → 传感器）；
- 硬件系统技术参数：
  - 传感器的信噪比 / 灵敏度 / 分辨率；
  - 采样系统分辨率 / 信噪比；
- 数据处理方法：增强、提取目标消息，抑制干扰。

### 成像物理模型

需要明确目标信息和信息载体（明确能量形式，进而确定传感器）。

基本成像坐标系：针孔相机模型。

相平面：成像的平面。

数字图像处理中，虚拟相平面在实物一侧，和真实相平面根据小孔对称。

变换公式：$x=\frac fZX=kX,y=\frac fZY=kY$，不再需要加负号。

### 图像数字化

采样：成像平面的离散化，【图像分辨率】（物理意义：每一个传感单元的面积；习惯表达：一共多少个采样单元）。

量化：图像值的离散化，【像素值的分辨率】。信噪比过大时，像素值分辨率过大没有意义。比如16bit的灰度，低的10bit都是噪声。

- 误区1：灰度的范围不是[0,255]，一般会更大的。
- 误区2：像素值的分辨率越高，图像越清晰。像素值的最优分辨率受信噪比限制。
- 误区3：图像的分辨率越高，图像越清晰。考虑信噪比=有效信号/本体噪声。只要传感器不是绝对零度，就会有本体噪声。光子数越多，有效信号越强。如果采样单元过小（图像分辨率高），光子数过少，以至于有效信号和本体噪声量级差不多的话，图像质量就很差了。
- 增大信噪比：给传感器降温，采用更大的光学镜头。（相机曝光速度越大，信噪比越小。）









